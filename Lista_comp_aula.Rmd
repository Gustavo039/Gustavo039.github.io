---
title: "Intervalos de credibilidade"
author: "Gustavo Almeida Silva"
output: 
  html_document:
    theme: yeti
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
```

# Questão 8

Dado $\bar{X}=54$ e $S=\sqrt{S^2}=4$ e assumindo a normalidade da população, iremos construir um intervalo de confiança de $95\%$ para $\mu$, utilizando o metodo da quantidade pivotal

Tendo $\bar{X}=54$ e a variancia populacional desconhecida, iremos propar a seguinte função do parametro e da amostra:
$$Q=\frac{\bar{X}-\mu}{S/\sqrt(n)}\text{, note que }Q\sim T_{n-1}$$

Para $95\%$ de credibilidade, temos que $\lambda_2=-\lambda_1=2.776445$.

E portanto o $I.C$ é dado por $P(\bar{X}-\frac{\lambda S}{\sqrt(n)}<\mu<\bar{X}+\frac{\lambda S}{\sqrt(n)})$


## A)
```{r}

x_samp_mean=54
x_samp_sd=4
n=5

error=(qt(0.975,df=4)*x_samp_sd)/sqrt(n)
l_int_1=x_samp_mean-error
u_int_1=x_samp_mean+error

df1=data.frame(Credibilidade=0.95,Lim_inf=l_int_1,Lim_sup=u_int_1)

```

```{r echo=FALSE}
curve(dt(x,df=4),from=-5,to=5)
abline(v=-2.77,col='red',lwd=3)
abline(v=2.77,col='red',lwd=3)

```

 Temos os seguintes valores: 
 
```{r echo=FALSE}
kbl(df1) %>%
    kable_classic(full_width = F, html_font = "Cambria")
```



## B)

Para $99\%$ de credibilidade, temos que $\lambda_2=-\lambda_1=4.604095$.

```{r}
x_samp_mean=54
x_samp_sd=4
n=5

error=(qt(0.995,df=4)*x_samp_sd)/sqrt(n)
l_int_2=x_samp_mean-error
u_int_2=x_samp_mean+error

df2=data.frame(Credibilidade=0.99,Lim_inf=l_int_2,Lim_sup=u_int_2)


```

```{r echo=FALSE}
curve(dt(x,df=4),from=-5,to=5)
abline(v=-4.604095,col='blue',lwd=3)
abline(v=4.604095,col='blue',lwd=3)

```

Temos os seguintes valores: 

```{r echo=FALSE}
kbl(df2) %>%
    kable_classic(full_width = F, html_font = "Cambria")
```


## C)

Comparando os intervalos:

```{r echo=FALSE}
curve(dt(x,df=4),from=-5,to=5)
abline(v=-4.604095,col='blue',lwd=3)
abline(v=4.604095,col='blue',lwd=3)
abline(v=-2.77,col='red',lwd=3)
abline(v=2.77,col='red',lwd=3)

```


E seus valores:

```{r echo=FALSE}
df_total=rbind(df1,df2)

kbl(df_total) %>%
    kable_classic(full_width = F, html_font = "Cambria")
```


# Questão 19

Neste exercicio estaremos propondo um $I.C$ para $p$, Assumindo a normalidade da população e dado a proporção amostral = $0.072$ e o desvio padrão amostral = $\sqrt{\frac{0.072(1-0.072)}{539}}=0.01171321$, iremos propar a seguinte função do parametro e da amostra:
$$Q=\frac{\hat{P}-P}{\sqrt{\hat{P}(1-\hat{P})/n}}\text{, note que }Q\sim N(0,1)$$

Para $95\%$ de credibilidade, temos que $\lambda=2.326348$.

E portanto o limite superior é dado por $P(\mu<\hat{P}+\lambda\sqrt{\frac{\hat{P}(1-\hat{P})}{n}})=$



```{r}
samp_prop=0.072
n=487
samp_q=1-samp_prop
samp_sd=sqrt(samp_prop*samp_q/n)


error=qnorm(0.99)*samp_sd
```


```{r}
(samp_prop+error)
```

```{r echo=FALSE}
curve(dnorm(x,mean = samp_prop,sd=samp_sd),from = samp_prop-0.05,to=samp_prop+0.05)
abline(v=samp_prop+error,col='red',lwd=3)
```

